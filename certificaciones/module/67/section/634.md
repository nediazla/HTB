# Herramientas útiles

---

Hay muchas herramientas disponibles para ayudarnos con los sistemas de Windows enumerados para vectores de escalada de privilegios comunes y oscuros. A continuación se muestra una lista de binarios y scripts útiles, muchos de los cuales cubriremos dentro de las próximas secciones del módulo.

|Herramienta|Descripción|
|---|---|
|[Cinturón de seguridad](https://github.com/GhostPack/Seatbelt)|Proyecto C# para realizar una amplia variedad de controles de escalada de privilegios locales|
|[Winpeas](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/winPEAS)|WinPeas es un script que busca posibles rutas para aumentar los privilegios en los hosts de Windows. Se explican todos los cheques[aquí](https://book.hacktricks.xyz/windows/checklist-windows-privilege-escalation)|
|[Encendido](https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Privesc/PowerUp.ps1)|Script PowerShell para encontrar vectores de escalada de privilegios de Windows comunes que se basan en configuraciones erróneas. También se puede utilizar para explotar algunos de los problemas encontrados|
|[Afilado](https://github.com/GhostPack/SharpUp)|Versión C# de PowerUp|
|[FAUCES](https://github.com/411Hall/JAWS)|Script PowerShell para enumerar los vectores de escalada de privilegios escritos en PowerShell 2.0|
|[Sesiongopher](https://github.com/Arvanaghi/SessionGopher)|SessionGopher es una herramienta PowerShell que encuentra y descifra la información de sesión guardada para herramientas de acceso remoto. Extrae Pastty, WinsCP, Superputty, Filezilla y RDP Información de sesión guardada|
|[Watson](https://github.com/rasta-mouse/Watson)|Watson es una herramienta .NET diseñada para enumerar los KB faltantes y sugerir hazañas para las vulnerabilidades de escalada de privilegios.|
|[Lazagne](https://github.com/AlessandroZ/LaZagne)|Herramienta utilizada para recuperar contraseñas almacenadas en una máquina local de navegadores web, herramientas de chat, bases de datos, GIT, correo electrónico, volcados de memoria, PHP, herramientas de Sysadmin, configuraciones de red inalámbricas, mecanismos internos de almacenamiento de contraseñas de Windows y más|
|[Windows Exploit Suggester - próxima generación](https://github.com/bitsadmin/wesng)|Wes-NG es una herramienta basada en la salida de Windows '`systeminfo`Utilidad que proporciona la lista de vulnerabilidades a las que el sistema operativo es vulnerable, incluidas las exploits para estas vulnerabilidades. Se admite cada sistema operativo Windows entre Windows XP y Windows 10, incluidas sus contrapartes de Windows Server,|
|[Suite de sysinternals](https://docs.microsoft.com/en-us/sysinternals/downloads/sysinternals-suite)|Utilizaremos varias herramientas de Sysinternals en nuestra enumeración, incluida[Accesschk](https://docs.microsoft.com/en-us/sysinternals/downloads/accesschk), [Canalista](https://docs.microsoft.com/en-us/sysinternals/downloads/pipelist), y[PSService](https://docs.microsoft.com/en-us/sysinternals/downloads/psservice)|

También podemos encontrar binarios precompilados de`Seatbelt`y`SharpUp` [aquí](https://github.com/r3motecontrol/Ghostpack-CompiledBinaries)y binarios independientes de`LaZagne` [aquí](https://github.com/AlessandroZ/LaZagne/releases/). Se recomienda que siempre compilemos nuestras herramientas de la fuente si las usamos en un entorno de cliente.

Nota: Dependiendo de cómo obtenemos acceso a un sistema, es posible que no tengamos muchos directorios que nuestro usuario escriba para cargar herramientas. Siempre es una apuesta segura cargar herramientas para`C:\Windows\Temp`Porque el`BUILTIN\Users`El grupo tiene acceso de escritura.

Esta no es una lista exhaustiva de herramientas disponibles para nosotros. Además, debemos esforzarnos por aprender qué hace cada herramienta si no funciona como se esperaba, o no podemos cargarlos en el sistema de destino. Herramientas como las mencionadas anteriormente son extremadamente útiles para reducir nuestros cheques y enfocar nuestra enumeración. Enumerar un sistema de Windows puede ser una tarea desalentadora con una inmensa cantidad de información para examinar y dar sentido. Las herramientas pueden hacer este proceso más rápido y también darnos más salida en un formato fácil de leer. Una desventaja de esto puede ser una sobrecarga de información, ya que algunas de estas herramientas, como`winPEAS`, devuelva una increíble cantidad de información que en su mayoría no nos sea útil. Las herramientas pueden ser una espada de doble filo. Si bien ayudan a acelerar el proceso de enumeración y proporcionarnos una salida altamente detallada, podríamos estar trabajando de manera menos eficiente si no sabemos cómo leer la salida o reducirlo a los puntos de datos más interesantes. Las herramientas también pueden producir falsos positivos, por lo que debemos tener una comprensión profunda de muchas posibles técnicas de escalada de privilegios para solucionar los problemas cuando las cosas salen mal o no son lo que parecen ser. Aprender las técnicas de enumeración manualmente ayudará a garantizar que no perdamos fallas obvias debido a un problema con una herramienta, como un falso negativo o falso positivo.

A lo largo de este módulo, mostraremos técnicas de enumeración manual para los diversos ejemplos que cubrimos y la salida de herramientas cuando corresponda. Además de las técnicas de enumeración, también es vital aprender cómo realizar los pasos de explotación manualmente y no confiar en scripts o herramientas "autopwn" que no podemos controlar. Está bien (¡y se alienta a escribir nuestras propias herramientas/scripts para realizar pasos de enumeración y explotación. Aún así, debemos tener suficiente confianza en ambas fases para explicar con precisión lo que le estamos haciendo a nuestro cliente en cualquier etapa del proceso. También deberíamos poder operar en un entorno en el que no podamos cargar herramientas (como una red o sistemas de aire que no tienen acceso a Internet o que nos permitan conectar un dispositivo externo como una unidad flash USB).

Estas herramientas no solo son beneficiosas para los evaluadores de penetración, sino que también pueden ayudar a los administradores de sistemas con sus trabajos al ayudar a identificar frutas de bajo contenido para solucionar antes de una evaluación, verificando periódicamente la postura de seguridad de algunas máquinas, analizando el impacto de una actualización u otros cambios, o realizando una revisión de seguridad en profundidad en una nueva imagen de oro antes de implementarlo en la producción. Las herramientas y métodos que se muestran en este módulo pueden beneficiar significativamente a cualquier persona a cargo de la administración de sistemas, la arquitectura o la seguridad y el cumplimiento interno.

Al igual que con cualquier automatización, puede haber riesgos para usar estas herramientas. Aunque es raro, realizar una enumeración excesiva podría causar inestabilidad del sistema o problemas con un sistema (o sistemas) que ya se sabe que son frágiles. Además, estas herramientas son bien conocidas, y la mayoría (si no todas) de ellas serán detectadas y bloqueadas por soluciones antivirus comunes, y ciertamente, por productos EDR más avanzados como cilance o negro de carbono. Veamos el último lanzamiento de la`LaZagne`herramienta al momento de la versión de escritura[2.4.3](https://github.com/AlessandroZ/LaZagne/releases/download/2.4.3/lazagne.exe). Cargar el total de binario precompilado a virus muestra que los productos 47/70 lo detectan.

![VirusTotal scan results for lazagne.exe, flagged as malicious by 47 out of 70 security vendors. File details include hash ed2f501408a7a6e1a854c29c4b0bc5648aaa8612432df829008931b3e34bf56, size 6.33 MB, and upload date 2021-06-20. Various detections include Application.Lazagne.H, Malware/Win64.RL_Generic.R297990, and Hacktool.Win32.LaZagne.3!c.](https://academy.hackthebox.com/storage/modules/67/VT_detected2.png)

Probablemente habríamos sido atrapados en el lugar si estuviéramos intentando ejecutar esto durante un compromiso evasivo. Durante otras evaluaciones, podemos encontrar protecciones que necesitamos para evitar nuestras herramientas. Aunque fuera de alcance para este módulo, podemos usar una variedad de métodos para que nuestras herramientas pasen los productos AV comunes, como eliminar comentarios, cambiar los nombres de funciones, encriptar el ejecutable, etc. Estas técnicas se enseñarán en un módulo posterior. Asumiremos que nuestro cliente objetivo ha establecido temporalmente el defensor de Windows en los hosts que estamos evaluando para no bloquear nuestras actividades para este módulo. Están buscando tantos problemas como sea posible y no están buscando probar sus defensas en esta etapa del juego.

[Anterior](https://academy.hackthebox.com/module/67/section/623)