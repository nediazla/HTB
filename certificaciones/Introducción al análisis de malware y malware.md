# Introducción al análisis de malware y malware

Es esencial aclarar que este módulo no afirma ser un programa exhaustivo o exhaustivo sobre análisis de malware. Este módulo proporciona una base sólida para los analistas de SOC, lo que les permite abordar con confianza las tareas clave de análisis de malware. El enfoque principal del módulo será el análisis de malware dirigido al sistema operativo Windows.

# **Definición de malware**

`Malware`, abreviatura de software malicioso, es un término que abarca varios tipos de software diseñados para infiltrarse, explotar o dañar los sistemas informáticos, redes y datos.

Aunque todo el malware se utiliza para intentos maliciosos, los objetivos específicos del malware pueden variar entre los actores de diferentes amenazas. Estos objetivos comúnmente entran en varias categorías:

- Interrumpir las operaciones del sistema de host
- Robar información crítica, incluidos datos personales y financieros
- Obtener acceso no autorizado a los sistemas
- Realización de actividades de espionaje
- Enviar mensajes de spam
- Utilización del sistema de víctima para ataques de denegación de servicio distribuido (DDoS)
- Implementación de ransomware para bloquear los archivos de la víctima en su host y exigir rescate

# **Tipos de malware**

En el mundo de las amenazas cibernéticas rápidas de hoy, nos encontramos con un amplio espectro de formas de malware complejas y variadas, que plantean un desafío implacable para nuestras defensas cibernéticas. Es primordial para nosotros comprender la naturaleza multifacética del software malicioso a medida que nos esforzamos por reforzar la seguridad de nuestros sistemas y redes. Repelemos las capas de algunos tipos de malware comúnmente visto con los que frecuentemente lidiamos en nuestros esfuerzos de ciberseguridad.

- `Viruses`: Estas formas notorias de malware están diseñadas para infiltrarse y multiplicarse dentro de los archivos de host, pasando de un sistema a otro. Se aferran a programas creíbles, entrando en acción cuando se activan los archivos infectados. Sus poderes destructivos pueden variar desde corrupir o alterar datos hasta interrupciones de las funciones del sistema e incluso propagarse a través de redes, lo que inflige estragos generalizados.
- `Worms`: Los gusanos son malware autónomo capaz de multiplicarse en redes sin necesidad de intervención humana. Explotan las debilidades de la red para infiltrarse en sistemas sin permiso. Una vez dentro, pueden entregar cargas útiles dañinas o seguir multiplicando a otros dispositivos vulnerables. Los gusanos pueden iniciar infecciones rápidas y crecientes, lo que resulta en una enorme interrupción e incluso a los posibles ataques de denegación de servicios.
- `Trojans`: También conocidos como caballos troyanos, estos están disfrazados como un software genuino para engañar a los usuarios para que los ejecute. Al ingresar a un sistema, elaboran las puestas traseras, lo que permite a los atacantes obtener un control no autorizado de forma remota. Los troyanos pueden ser armados para robar datos confidenciales, como contraseñas o información financiera, y orquestar otras actividades dañinas en el sistema comprometido.
- `Ransomware`: Este tipo malicioso de archivos de malware cifra en el sistema del objetivo, haciéndolos inseguibles. Los atacantes luego exigen un rescate a cambio de la clave de descifrado, manteniendo efectivamente los datos de la víctima al rescate. Los impactos de los ataques de ransomware pueden debilitar a las organizaciones e individuos por igual, lo que lleva a daños financieros y de reputación graves.
- `Spyware`: Este tipo de malware reúne sigilosamente datos confidenciales y actividades del usuario sin su consentimiento. Puede rastrear hábitos de navegación en línea, registrar las teclas de teclas y capturar credenciales de inicio de sesión, lo que representa un riesgo severo para la privacidad y la seguridad. Los datos robados a menudo se envían a servidores remotos para fines dañinos.
- `Adware`: Aunque no es tan destructivo, el adware aún puede ser una molestia y una amenaza de seguridad. Muestra anuncios no invitados e invasivos en sistemas infectados, lo que a menudo resulta en una mala experiencia del usuario. Adware también puede rastrear el comportamiento del usuario y recopilar datos para la publicidad dirigida.
- `Botnets`: Estas son redes de dispositivos comprometidos, a menudo denominados bots o zombies, controlados por un servidor central de comando y control (C2). Las botnets se pueden explotar para una variedad de actividades dañinas, incluido el lanzamiento de ataques DDoS, propagación de spam o diseminando otros malware.
- `Rootkits`: Estas son formas sigilosas de malware diseñadas para obtener acceso y control no autorizados sobre los componentes fundamentales (la "raíz") de un sistema operativo. Alteran las funciones del sistema para ocultar su presencia, haciéndolas extremadamente desafiantes para detectar y eliminar. Los atacantes pueden utilizar Rootkits para mantener el acceso prolongado y esquivar los protocolos de seguridad.
- `Backdoors/RATs (Remote Access Trojans)`: Las puertas traseras y las ratas están diseñadas para ofrecer acceso y control no autorizados sobre sistemas comprometidos desde ubicaciones remotas. Los atacantes pueden aprovecharlos para retener el control prolongado, extraer datos o instigar ataques adicionales.
- `Droppers`: Estos son un tipo de malware utilizado para transportar e instalar cargas útiles extra maliciosas en sistemas infectados. Sirven como conducto para otro malware, asegurando la instalación encubierta y la ejecución de amenazas más sofisticadas.
- `Information Stealers`: Estos están adaptados a los datos de apuntar y extraer datos confidenciales, como credenciales de inicio de sesión, información personal o propiedad intelectual, para fines dañinos. Esto incluye robo de identidad o vender los datos en la web oscura.

Estos ejemplos apenas rascan la superficie de los tipos de malware que enfrentamos en el panorama de amenazas de hoy. Es esencial recordar que los ciberdelincuentes refinan constantemente sus estrategias, técnicas y variantes de malware para evitar la detección y explotar nuevas vulnerabilidades.

# **Muestras de malware**

Cuando se trata de mejorar nuestras defensas de ciberseguridad y comprender las amenazas que existen, a veces tenemos que sumergirnos en los rincones oscuros del mundo cibernético. Esto significa tener en nuestras manos las muestras de malware reales, ya sea para investigaciones, análisis o fines educativos. Sin embargo, es crucial enfatizar que el tratamiento de muestras de malware reales debe hacerse en un entorno seguro y controlado para evitar infecciones accidentales y daños potenciales. Aquí hay algunos recursos, tanto gratuitos como pagados, donde podemos encontrar tales muestras.

- [Virusshare](https://virusshare.com/): Un excelente recurso para investigadores de malware, Virusshare alberga una vasta colección de muestras de malware. Actualmente tienen más de 30 millones de muestras en su repositorio, todas las cuales están disponibles gratuitamente para el público.
- [Análisis híbrido](https://www.hybrid-analysis.com/): Este sitio web nos permite enviar archivos para el análisis de malware. Sin embargo, también tienen una alimentación pública de sus análisis, donde a menudo se comparten muestras de malware.
- [Tezoo](https://github.com/ytisf/theZoo): Un repositorio de GitHub que contiene una colección de malware en vivo para análisis y educación. El repositorio también contiene información adicional sobre cada muestra, como su familia y el tipo de actividades que realiza.
- [Malware-tramphic-analysis.net](https://malware-traffic-analysis.net/): Este sitio web proporciona ejercicios de análisis de tráfico que pueden ser extremadamente beneficiosos para las personas que intentan aprender sobre los patrones de tráfico de malware. A menudo proporcionan archivos PCAP de tráfico real de malware, que pueden ser bastante informativos.
- [Virusta](https://www.virustotal.com/): Virustotal inspecciona elementos con más de 70 escáneres antivirus y servicios de lista de bloqueo URL/dominio, además de una miríada de herramientas para extraer señales del contenido estudiado. Cualquier usuario puede seleccionar un archivo de su computadora usando su navegador y enviarlo a Virustotal. Virustotal ofrece una serie de métodos de envío de archivos, incluida la interfaz web pública principal, los cargadores de escritorio, las extensiones del navegador y una API programática.
- [Any.run](https://app.any.run/): Una caja de arena en línea interactiva para el análisis de malware. El servicio permite a los investigadores analizar el comportamiento de malware ejecutando muestras en un entorno controlado. Si bien ofrece niveles gratuitos y pagados, incluso la versión gratuita proporciona acceso a envíos públicos, que pueden incluir varias muestras de malware.
- [Volcado de malware contagio](https://contagiodump.blogspot.com/): Contagio Dump es una colección de muestras de malware, informes de amenazas y recursos relacionados seleccionados por un investigador de malware llamado Mila. El sitio proporciona acceso directo y anonimizado a una amplia gama de muestras de malware, incluidos varios tipos de troyanos, gusanos, ransomware y exploits. Es utilizado con frecuencia por investigadores de seguridad y analistas para estudiar el comportamiento de malware y desarrollar técnicas de mitigación.
- [VX Underground](https://www.vx-underground.org/): VX-subground es una de las colecciones más grandes de código fuente de malware, artículos y documentos en Internet. Su objetivo es recolectar, preservar y compartir todo tipo de materiales relacionados con el malware, la explotación y la cultura de piratería. Este recurso es valioso para los investigadores de seguridad y los entusiastas que desean estudiar la construcción y el comportamiento de malware desde una perspectiva más técnica y centrada en el código.

# **Adquisición de malware/evidencia**

Cuando se trata de recopilar evidencia durante una investigación forense digital o respuesta de incidentes, tener las herramientas adecuadas para realizar imágenes de disco y adquisición de memoria es crucial. Discutamos algunas soluciones gratuitas que podemos usar para recopilar los datos necesarios para nuestras investigaciones.

### **Soluciones de imágenes de disco**

- [FTK Imager](https://www.exterro.com/ftk-imager): Desarrollado por AccessData (ahora adquirido por Exterro), FTK Imager es una de las herramientas de imagen de disco más utilizadas en el campo de ciberseguridad. Nos permite crear copias (o imágenes) perfectas de discos informáticos para el análisis, preservando la integridad de la evidencia. También nos permite ver y analizar el contenido de los dispositivos de almacenamiento de datos sin alterar los datos.
- [OSFClone](https://www.osforensics.com/tools/create-disk-images.html): Una utilidad gratuita de código abierto diseñada para la tarea de crear y clonar imágenes de disco forense. Es fácil de usar y admite una amplia variedad de sistemas de archivos.
- `DD and DCFLDD`: Ambos son utilidades de línea de comandos disponibles en sistemas basados en UNIX (incluidos Linux y MacOS). DD es una herramienta versátil incluida en la mayoría de los sistemas basados en UNIX de forma predeterminada, mientras que DCFLDD es una versión mejorada de DD con características específicamente útiles para forenses, como el hash.

### **Soluciones de adquisición de memoria**

- [Dumpit](https://www.magnetforensics.com/resources/magnet-dumpit-for-windows/): Una utilidad simplista que genera un volcado de memoria física de Windows y Linux Machines. En Windows, concatena la memoria física del sistema de 32 y 64 bits en un solo archivo de salida, lo que lo hace extremadamente fácil de usar.
- [Memdump](http://www.nirsoft.net/utils/nircmd.html): Memdump es una utilidad de línea de comandos gratuita y directa que nos permite capturar el contenido de la RAM de un sistema. Es bastante beneficioso en las investigaciones forenses o al analizar un sistema para actividades maliciosas. Su simplicidad y facilidad de uso lo convierten en una opción popular para la adquisición de memoria.
- [Belkasoft Ram Capturer](https://belkasoft.com/ram-capturer): Esta es otra herramienta poderosa que podemos usar para la adquisición de memoria, proporcionada de forma gratuita por Belkasoft. Puede capturar la RAM de una computadora con Windows en ejecución, incluso si hay una protección activa anti-debuges o antidumping. Esto lo convierte en una herramienta altamente efectiva para extraer tantos datos como sea posible durante una investigación forense en vivo.
- [Captura de Ram de Magnet](https://www.magnetforensics.com/resources/magnet-ram-capture/): Desarrollado por Magnet Forensics, esta herramienta proporciona una forma gratuita y simple de capturar la memoria volátil de un sistema.
- [Lime (extractor de memoria de Linux)](https://github.com/504ensicsLabs/LiME): La cal es un módulo de núcleo cargable (LKM) que permite la adquisición de la memoria volátil. La cal es única en el sentido de que está diseñado para ser transparente al sistema objetivo, evadiendo muchas medidas anti-forenses comunes.

### **Otras soluciones de adquisición de evidencia**

- [Kape (Kroll Artifact Parser y Extractor)](https://www.kroll.com/en/services/cyber-risk/incident-response-litigation-support/kroll-artifact-parser-extractor-kape): Kape es un programa de triaje diseñado para ayudar a coleccionar y analizar artefactos de manera rápida y efectiva. Se centra en la recopilación dirigida, reduciendo el volumen de datos recopilados y el tiempo requerido para el análisis. Kape es gratuito para su uso y es una herramienta esencial en nuestro kit de herramientas forenses digitales.
- [Velociraptor](https://github.com/Velocidex/velociraptor): Velociraptor es una herramienta versátil diseñada para la respuesta de incidentes basada en el host y los forenses digitales. Permite una recopilación rápida de datos dirigidos en una amplia cantidad de máquinas. Velociraptor emplea el lenguaje de consultas Velocidex (VQL), una herramienta poderosa para recolectar y manipular artefactos. La naturaleza de código abierto de Velociraptor lo convierte en una herramienta gratuita valiosa en nuestro arsenal.

---

# **Definición, propósito y actividades comunes de análisis de malware**

El proceso de comprender el comportamiento y el funcionamiento interno del malware se conoce como`Malware Analysis`, un aspecto crucial de la ciberseguridad que ayuda a comprender la amenaza que plantea el software malicioso e ideando contramedidas efectivas.

En nuestra búsqueda del análisis de malware, profundizamos en el código, la estructura y la funcionalidad del malware para obtener información profunda sobre su propósito, métodos de propagación e impacto potencial en los sistemas específicos. Al responder preguntas pertinentes, como el tipo de malware (p. Ej., SpyBot, Keylogger, Ransomware), su comportamiento previsto en los puntos finales, el consecuencia de su ejecución (incluidos los artefactos generados en la red o el punto final y posibles conexiones con el comando y el control (C2) servidores), el extenso de daños puede infligir, su atribución de amenazas específicas, y la creación de las reglas de detección del análisis de la mulware de la mulware, el análisis de los grupos de la amenaza entera en el análisis de la detección de los grupos de detección de la mulware. Red, podemos diseñar mecanismos de defensa sólidos contra estas amenazas.

El análisis de malware sirve a varios fundamentos`purposes`, como:

- `Detection and Classification`: Al analizar el malware, podemos identificar y clasificar diferentes tipos de amenazas en función de sus características, firmas o patrones únicos. Esto nos permite desarrollar reglas de detección y capacita a los profesionales de la seguridad para obtener una comprensión integral de la naturaleza del malware que encuentran.
- `Reverse Engineering`: El análisis de malware a menudo implica el intrincado proceso de ingeniería inversa El código del malware para discernir sus operaciones subyacentes y técnicas empleadas. Esto puede presentar funcionalidades ocultas, métodos de cifrado, detalles sobre la infraestructura de comando y control y técnicas utilizadas para la ofuscación y la evasión.
- `Behavioral Analysis`: Al estudiar meticulosamente el comportamiento del malware durante la ejecución, obtenemos información sobre sus acciones, como modificaciones al sistema de archivos, comunicaciones de red, cambios en el registro del sistema e intenta explotar las vulnerabilidades. Este análisis proporciona información invaluable sobre el impacto del malware en los sistemas infectados y ayuda a diseñar posibles contramedidas.
- `Threat Intelligence`: A través del análisis de malware, los investigadores de amenazas pueden acumular inteligencia crítica sobre los atacantes, sus tácticas, técnicas y procedimientos (TTP) y los orígenes del malware. Esta valiosa inteligencia se puede compartir con la comunidad de seguridad más amplia para mejorar las capacidades de detección, prevención y respuesta.

El`techniques`empleado en el análisis de malware abarca una amplia gama de métodos y herramientas, que incluyen:

- `Static Analysis`: Este enfoque implica analizar el código del malware sin ejecutarlo, examinar la estructura de archivos, identificar cadenas, buscar firmas conocidas y estudiar metadatos para obtener información preliminares sobre las características del malware.
- `Dynamic Analysis`: El análisis dinámico implica ejecutar el malware dentro de un entorno controlado, como una caja de arena o una máquina virtual, para observar su comportamiento y capturar sus actividades de tiempo de ejecución. Esto incluye monitorear el tráfico de red, las llamadas del sistema, las modificaciones del sistema de archivos y otras interacciones.
- `Code Analysis`: Code analysis (includes reverse engineering) and involves disassembling or decompiling the malware's code to understand its logic, functions, algorithms, and employed techniques. This helps in identifying concealed functionalities, exploitation methods, encryption methods, details about the command-and-control infrastructure, and techniques used for obfuscation and evasion. Ιnferentially, code analysis can also help in uncovering potential Indicators of Compromise (IOCs).
- `Memory Analysis`: Analizar las interacciones del malware con la memoria del sistema ayuda a identificar el código inyectado, los ganchos u otras manipulaciones de tiempo de ejecución. Esto puede ser fundamental para detectar RootKits, analizar técnicas anti-análisis o identificar cargas útiles maliciosas.
- `Malware Unpacking`: Esta técnica se refiere al proceso de extracción y aislamiento del código malicioso oculto dentro de una pieza de malware que utiliza técnicas de embalaje para evadir la detección. Los autores de malware utilizan los empacadores para comprimir, encriptar u ofuscar su código malicioso, lo que dificulta el software antivirus y otras herramientas de seguridad para identificar la amenaza. El desempaquetado implica la ingeniería inversa de estas técnicas de embalaje para revelar el código original no obfuscado para su posterior análisis. Esto puede permitir a los investigadores comprender la funcionalidad, el comportamiento y el impacto potencial del malware.

---

En el panorama de amenazas en constante evolución de hoy, el uso del análisis de malware juega un papel fundamental en nuestras estrategias de defensa de ciberseguridad. A medida que las amenazas cibernéticas se vuelven cada vez más sofisticadas, debemos mejorar continuamente nuestras capacidades para identificar, analizar y mitigar los riesgos planteados por el software malicioso.

A través del análisis de malware, obtenemos ideas invaluables sobre la naturaleza de las amenazas que enfrentamos. Comprender los atributos específicos del malware nos permite adaptar nuestras tácticas de respuesta en consecuencia, abordando cada amenaza con precisión.