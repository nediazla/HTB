# Herramientas del comercio

---

Muchas de las secciones del módulo requieren herramientas como scripts de código abierto o binarios precompilados. Estos se pueden encontrar en el`C:\Tools`Directorio en los hosts de Windows proporcionados en las secciones destinadas a atacar desde Windows. En las secciones que se centran en atacar AD de Linux, proporcionamos un host Linux Parrot personalizado para el entorno de destino como si fuera un usuario anónimo con un host de ataque dentro de la red interna. Todas las herramientas y scripts necesarios están precargados en este host (ya sea instalado o en el`/opt`directorio). Aquí hay una lista de muchas de las herramientas que cubriremos en este módulo:

| Herramienta                                                                                                                               | Descripción                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| ----------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| [PowerView](https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1)/[Aguja](https://github.com/dmchell/SharpView) | Una herramienta de PowerShell y un puerto .NET del mismo se utiliza para obtener conciencia situacional en AD. Estas herramientas se pueden usar como reemplazos para varias ventanas`net*`comandos y más. PowerView y Sharpview pueden ayudarnos a recopilar gran parte de los datos que BloodHound hace, pero requiere más trabajo para hacer relaciones significativas entre todos los puntos de datos. Estas herramientas son excelentes para verificar qué acceso adicional podemos tener con un nuevo conjunto de credenciales, dirigirse a usuarios o computadoras específicas, o encontrar algunas "victorias rápidas", como los usuarios que pueden ser atacados a través de Kerberoasting o Ascreading. |
| [Sabueso](https://github.com/BloodHoundAD/BloodHound)                                                                                     | Se utiliza para mapear visualmente las relaciones publicitarias y ayudar a planificar las rutas de ataque que de otro modo pueden pasar desapercibidas. Usa el[Sharphound](https://github.com/BloodHoundAD/BloodHound/tree/master/Collectors)PowerShell o C# Ingestor para recopilar datos para que luego se importen a la aplicación Bloodhound JavaScript (Electron) con un[Neo4J](https://neo4j.com/)Base de datos para análisis gráfico del entorno AD.                                                                                                                                                                                                                                                       |
| [Sharphound](https://github.com/BloodHoundAD/BloodHound/tree/master/Collectors)                                                           | El recopilador de datos de C# para recopilar información de Active Directory sobre variables objetos AD como usuarios, grupos, computadoras, ACL, GPO, atributos de usuario y computadora, sesiones de usuario y más. La herramienta produce archivos JSON que luego se pueden ingerir en la herramienta GUI de Bloodhound para su análisis.                                                                                                                                                                                                                                                                                                                                                                      |
| [Bloodhound.py](https://github.com/fox-it/BloodHound.py)                                                                                  | Un ingestor de sangre a base de pitón basado en el[Kit de herramientas de impacket](https://github.com/CoreSecurity/impacket/). Apoya la mayoría de los métodos de recolección de sabuesos y se puede ejecutar desde un huésped de ataque no unido al dominio. La salida se puede ingerir en la GUI de Bloodhound para su análisis.                                                                                                                                                                                                                                                                                                                                                                               |
| [Kerbrute](https://github.com/ropnop/kerbrute)                                                                                            | Una herramienta escrita en GO que utiliza la preautenticación de Kerberos para enumerar las cuentas de Active Directory, realizar la pulverización de contraseñas y el forzo bruto.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [Kit de herramientas de impacket](https://github.com/SecureAuthCorp/impacket)                                                             | Una colección de herramientas escritas en Python para interactuar con protocolos de red. El conjunto de herramientas contiene varios scripts para enumerar y atacar Active Directory.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| [Respondedor](https://github.com/lgandx/Responder)                                                                                        | El respondedor es una herramienta especialmente diseñada para envenenar LLMNR, NBT-NS y MDNS, con muchas funciones diferentes.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| [Inveigh.ps1](https://github.com/Kevin-Robertson/Inveigh/blob/master/Inveigh.ps1)                                                         | Similar al respondedor, una herramienta PowerShell para realizar varios ataques de suplantación de redes y envenenamiento.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [C# Inveigh (Inveighzero)](https://github.com/Kevin-Robertson/Inveigh/tree/master/Inveigh)                                                | La versión C# de Inveigh con una consola semi-interactiva para interactuar con datos capturados como el nombre de usuario y los hash de contraseña.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [rpcinfo](https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/rpcinfo)                                       | La utilidad RPCINFO se utiliza para consultar el estado de un programa RPC o enumerar la lista de servicios RPC disponibles en un host remoto. La opción "-P" se usa para especificar el host de destino. Por ejemplo, el comando "RPCINFO -P 10.0.0.1" devolverá una lista de todos los servicios RPC disponibles en el host remoto, junto con su número de programa, número de versión y protocolo. Tenga en cuenta que este comando debe ejecutarse con privilegios suficientes.                                                                                                                                                                                                                               |
| [rpcclient](https://www.samba.org/samba/docs/current/man-html/rpcclient.1.html)                                                           | Una parte de la suite Samba en distribuciones de Linux que se puede utilizar para realizar una variedad de tareas de enumeración de Active Directory a través del servicio RPC remoto.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [CrackMapexec (CME)](https://github.com/byt3bl33d3r/CrackMapExec)                                                                         | CME es un conjunto de herramientas de enumeración, ataque y post-explotación que puede ayudarnos en gran medida en la enumeración y la realización de ataques con los datos que recopilamos. CME intenta "vivir de la tierra" y abusar de las características y protocolos de anuncios incorporados como SMB, WMI, WinRM y MSSQL.                                                                                                                                                                                                                                                                                                                                                                                 |
| [Rubeo](https://github.com/GhostPack/Rubeus)                                                                                              | Rubeo es una herramienta C# construida para el abuso de Kerberos.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| [GetUserspns.py](https://github.com/SecureAuthCorp/impacket/blob/master/examples/GetUserSPNs.py)                                          | Otro módulo de Impacket orientado a encontrar nombres principales de servicio vinculados a usuarios normales.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| [Hashcat](https://hashcat.net/hashcat/)                                                                                                   | Una gran herramienta de grietas y recuperación de contraseñas.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| [enum4linux](https://github.com/CiscoCXSecurity/enum4linux)                                                                               | Una herramienta para enumerar información de los sistemas Windows y Samba.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [enum4linux-ng](https://github.com/cddmp/enum4linux-ng)                                                                                   | Una reelaboración de la herramienta enum4linux original que funciona de manera un poco diferente.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| [ldapsearch](https://linux.die.net/man/1/ldapsearch)                                                                                      | Interfaz incorporada para interactuar con el protocolo LDAP.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [Windapsearch](https://github.com/ropnop/windapsearch)                                                                                    | Un script de Python utilizado para enumerar a los usuarios de anuncios, grupos y computadoras utilizando consultas LDAP. Útil para automatizar consultas LDAP personalizadas.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| [DomainPasswordSpray.ps1](https://github.com/dafthack/DomainPasswordSpray)                                                                | DomainPasswordSpray es una herramienta escrita en PowerShell para realizar un ataque con contraseña contra los usuarios de un dominio.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [Cojinete de lapsia](https://github.com/leoloobeek/LAPSToolkit)                                                                           | El kit de herramientas incluye funciones escritas en PowerShell que aprovechan PowerView para auditar y atacar entornos de Active Directory que han implementado la solución de contraseña de administrador local de Microsoft (LAPS).                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [smbmap](https://github.com/ShawnDEvans/smbmap)                                                                                           | SMB comparte la enumeración en un dominio.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [psexec.py](https://github.com/SecureAuthCorp/impacket/blob/master/examples/psexec.py)                                                    | Parte del kit de herramientas de Impacket, nos proporciona una funcionalidad similar a PSEXEC en forma de un caparazón semi-interactivo.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [wmiexec.py](https://github.com/SecureAuthCorp/impacket/blob/master/examples/wmiexec.py)                                                  | Parte del conjunto de herramientas de Impacket, proporciona la capacidad de ejecución de comandos a través de WMI.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| [Snaffer](https://github.com/SnaffCon/Snaffler)                                                                                           | Útil para encontrar información (como credenciales) en Active Directory en computadoras con acciones de archivo accesibles.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| [smbserver.py](https://github.com/SecureAuthCorp/impacket/blob/master/examples/smbserver.py)                                              | Ejecución simple del servidor SMB para interacción con hosts de Windows. Forma fácil de transferir archivos dentro de una red.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| [setspn.exe](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc731241\(v=ws.11\))       | Agrega, lee, modifica y elimina la propiedad del directorio de nombres principales del servicio (SPN) para una cuenta de servicio de Active Directory.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [Mimikatz](https://github.com/ParrotSec/mimikatz)                                                                                         | Realiza muchas funciones. En particular, los ataques de pase, extrayendo contraseñas de texto sin formato y extracción de boletos de Kerberos de la memoria en un host.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [secretsdump.py](https://github.com/SecureAuthCorp/impacket/blob/master/examples/secretsdump.py)                                          | Vuelva a colocar los secretos de Sam y LSA de un host.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [Evil-Winrm](https://github.com/Hackplayers/evil-winrm)                                                                                   | Nos proporciona un caparazón interactivo en un host sobre el protocolo WinRM.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| [mssqlclient.py](https://github.com/SecureAuthCorp/impacket/blob/master/examples/mssqlclient.py)                                          | Parte del conjunto de herramientas de Impacket, proporciona la capacidad de interactuar con las bases de datos MSSQL.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| [nopac.py](https://github.com/Ridter/noPac)                                                                                               | Explotar el combo con CVE-2021-42278 y CVE-2021-42287 para hacerse pasar por DA del usuario de dominio estándar.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| [rpcdump.py](https://github.com/SecureAuthCorp/impacket/blob/master/examples/rpcdump.py)                                                  | Parte del conjunto de herramientas de Impacket, RPC Endpoint Mapper.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| [CVE-2021-1675.py](https://github.com/cube0x0/CVE-2021-1675/blob/main/CVE-2021-1675.py)                                                   | PrintnightMare POC en Python.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| [ntlmrelayx.py](https://github.com/SecureAuthCorp/impacket/blob/master/examples/ntlmrelayx.py)                                            | Parte del conjunto de herramientas de Impacket, realiza ataques de retransmisión SMB.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| [Petitpotam.py](https://github.com/topotam/PetitPotam)                                                                                    | La herramienta POC para CVE-2021-36942 para coaccionar los hosts de Windows para autenticarse a otras máquinas a través de MS-EFSRPC EFSRPCOPENFILERAW u otras funciones.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| [gettgtpkinit.py](https://github.com/dirkjanm/PKINITtools/blob/master/gettgtpkinit.py)                                                    | Herramienta para manipular certificados y TGTS.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [getnthash.py](https://github.com/dirkjanm/PKINITtools/blob/master/getnthash.py)                                                          | Esta herramienta utilizará un TGT existente para solicitar un PAC para el usuario actual que usa U2U.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| [adidnsdump](https://github.com/dirkjanm/adidnsdump)                                                                                      | Una herramienta para enumerar y descargar registros DNS de un dominio. Similar a realizar una transferencia de zona DNS.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [GPP-Decrypt](https://github.com/t0thkr1s/gpp-decrypt)                                                                                    | Extrae nombres de usuario y contraseñas de los archivos de preferencias de políticas grupales.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| [GetNpusers.py](https://github.com/SecureAuthCorp/impacket/blob/master/examples/GetNPUsers.py)                                            | Parte del kit de herramientas de Impacket. Se usa para realizar el ataque ASPROASTING para enumerar y obtener hashs as-REP para los usuarios con el conjunto de 'no requiere kerberos preauthentication'. Estos hashes se alimentan a una herramienta como el hashcat para intentos de agrietamiento de contraseña fuera de línea.                                                                                                                                                                                                                                                                                                                                                                                |
| [lookupsid.py](https://github.com/SecureAuthCorp/impacket/blob/master/examples/lookupsid.py)                                              | Herramienta Sid Bruteforcing.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| [Ticketer.py](https://github.com/SecureAuthCorp/impacket/blob/master/examples/ticketer.py)                                                | Una herramienta para la creación y personalización de los boletos TGT/TGS. Se puede utilizar para la creación de boletos de oro, ataques de confianza para padres, etc.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [raisechild.py](https://github.com/SecureAuthCorp/impacket/blob/master/examples/raiseChild.py)                                            | Parte del conjunto de herramientas de Impacket, es una herramienta para la escalada automatizada de privilegios de dominio para niños a padres.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [Active Directory Explorer](https://docs.microsoft.com/en-us/sysinternals/downloads/adexplorer)                                           | Active Directory Explorer (Ad Explorer) es un visor y editor de anuncios. Se puede usar para navegar una base de datos de anuncios y ver las propiedades y atributos del objeto. También se puede usar para guardar una instantánea de una base de datos de anuncios para el análisis fuera de línea. Cuando se carga una instantánea de anuncios, se puede explorar como una versión en vivo de la base de datos. También se puede usar para comparar dos instantáneas de la base de datos de anuncios para ver cambios en objetos, atributos y permisos de seguridad.                                                                                                                                           |
| [Pingcastle](https://www.pingcastle.com/documentation/)                                                                                   | Utilizado para auditar el nivel de seguridad de un entorno publicitario basado en un marco de evaluación de riesgos y madurez (basado en[Cmmi](https://en.wikipedia.org/wiki/Capability_Maturity_Model_Integration)adaptado a la seguridad publicitaria).                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| [Grupo3r](https://github.com/Group3r/Group3r)                                                                                             | Group3R es útil para auditar y encontrar configuraciones erróneas de seguridad en objetos de política de grupo publicitario (GPO).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| [Adreciente](https://github.com/adrecon/ADRecon)                                                                                          | Una herramienta utilizada para extraer varios datos de un entorno de anuncios objetivo. Los datos se pueden emitir en formato de Microsoft Excel con vistas resumidas y análisis para ayudar con el análisis y pintar una imagen del estado de seguridad general del entorno.                                                                                                                                                                                                                                                                                                                                                                                                                                     |