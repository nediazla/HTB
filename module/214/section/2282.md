# Threat Hunting Glossary

Dentro del ámbito de la ciberseguridad y la caza de amenazas, varios términos y conceptos cruciales desempeñan un papel fundamental. Aquí hay una comprensión enriquecida de estos:

- `Adversary`: Un adversario, dentro del ámbito de Cyber ​​Threat Intelligence (CTI), se refiere a una entidad impulsada por objetivos compartidos como su organización, aunque no autorizada, que busca infiltrarse en su negocio y satisfacer sus requisitos de recopilación, que pueden incluir ganancias financieras, información privilegiada, o propiedad intelectual valiosa. Estos adversarios poseen distintos niveles de experiencia técnica y están motivados para eludir sus medidas de seguridad.
    
    Los adversarios se pueden clasificar en distintas categorías, incluidas `cyber criminals`, `insider threats`, `hacktivists`, o `state-sponsored operators`. Cada categoría exhibe características y motivaciones únicas en su búsqueda de acceso y explotación no autorizados.
    
- `Advanced Persistent Threat (APT)`: Las APT suelen estar asociadas con grupos altamente organizados o entidades de estados-nación que poseen amplios recursos, lo que les permite llevar a cabo sus actividades maliciosas durante períodos prolongados. Si bien las APT se dirigen a diversos sectores, muestran una marcada preferencia por objetivos de alto valor, que pueden incluir organizaciones gubernamentales, infraestructuras sanitarias y sistemas de defensa.
    
    Al contrario de lo que sugiere el nombre, ser etiquetado como APT no implica necesariamente que el grupo utilice técnicas tecnológicamente avanzadas. Más bien, el aspecto "Avanzado" puede referirse a la planificación estratégica sofisticada, y "Persistente" alude a su tenaz perseverancia en el logro de sus objetivos, respaldada por recursos sustanciales que incluyen, entre otros, respaldo financiero, mano de obra y tiempo.
    
- `Tactics, Techniques, and Procedures (TTPs)`: Término tomado del ejército, los TTP simbolizan los distintos patrones operativos o la "firma" de un adversario.
    - `Tactics`: Este término describe los objetivos estratégicos y los conceptos de operaciones de alto nivel empleados por el adversario. Básicamente, aborda el "por qué" detrás de sus acciones.
    - `Techniques`: Estos son los métodos específicos utilizados por un adversario para lograr sus objetivos tácticos, proporcionando el "cómo" detrás de sus acciones. Las técnicas no proporcionan instrucciones paso a paso sino que describen el enfoque general para lograr un objetivo.
    - `Procedures`: Estas son instrucciones detalladas paso a paso, esencialmente la "receta" para la implementación de cada técnica.
    
    El análisis de los TTP ofrece conocimientos profundos sobre cómo un adversario penetra una red, se mueve lateralmente dentro de ella y logra sus objetivos. Comprender los TTP permite la creación de indicadores de compromiso (IOC), que pueden ayudar a detectar y frustrar futuros ataques.
    
- `Indicator`: Un indicador, cuando se analiza en CTI, abarca tanto datos técnicos como información contextual. Los datos técnicos aislados que carecen de contexto relevante tienen un valor limitado o insignificante para los defensores de la red. Los detalles contextuales permiten una comprensión integral de la importancia del indicador, lo que permite un análisis y una respuesta a las amenazas eficaces.
    
    ![](https://academy.hackthebox.com/storage/modules/214/indicator.png)
    
- `Threat`: Una amenaza es un concepto multifacético que consta de tres factores fundamentales: intención, capacidad y oportunidad.
    
    ![](https://academy.hackthebox.com/storage/modules/214/threat.png)
    
    En primer lugar, `intent` significa la razón subyacente que impulsa a los adversarios a apuntar y explotar su infraestructura de red. Esta intención puede variar desde espionaje corporativo hasta ganancias financieras mediante delitos cibernéticos o incluso apuntar a sus relaciones comerciales con otras entidades.
    
    En segundo lugar, `capability` denota las herramientas, recursos y respaldo financiero que poseen los adversarios para llevar a cabo sus operaciones con éxito. Su nivel de habilidad para penetrar su red y la disponibilidad de recursos financieros suficientes determinan su capacidad para soportar ataques continuos contra su organización.
    
    Por último, `opportunity` Se refiere a condiciones o eventos que brindan circunstancias favorables para que los adversarios ejecuten sus operaciones. Esto abarca casos en los que los adversarios adquieren direcciones de correo electrónico o credenciales relevantes de su red, así como su conocimiento de las vulnerabilidades en sistemas de software específicos.
    
- `Campaign`: Una campaña se refiere a una colección de incidentes que comparten tácticas, técnicas y procedimientos (TTP) similares y se cree que tienen requisitos de recopilación comparables. Este tipo de inteligencia requiere mucho tiempo y esfuerzo para agregarla y analizarla, a medida que las empresas y organizaciones informan y descubren progresivamente actividades maliciosas relacionadas.
- `Indicators of Compromise (IOCs)`: Los IOC son rastros digitales o artefactos derivados de intrusiones activas o pasadas. Sirven como "señales" de un adversario específico o de una actividad maliciosa. Los IOC pueden incluir una amplia gama de elementos, como hashes de archivos maliciosos, direcciones IP sospechosas, URL, nombres de dominio y nombres de ejecutables o scripts maliciosos. El seguimiento, la catalogación y el análisis continuo de los IOC pueden mejorar en gran medida nuestras capacidades de detección de amenazas, lo que lleva a respuestas más rápidas y efectivas a las amenazas cibernéticas.
- `Pyramid of Pain`: Pyramid of Pain es una visualización crítica que presenta una jerarquía de indicadores que pueden ayudarnos a detectar adversarios. También muestra el grado de dificultad para adquirir estos indicadores específicos y el impacto posterior de la recopilación de inteligencia sobre ellos. El concepto de la Pirámide del Dolor cobró vida gracias a David Bianco de FireEye en su reveladora presentación.[Detección y respuesta impulsadas por Intel para aumentar el costo de las operaciones de su adversario.](https://rvasec.com/slides/2014/Bianco_Pyramid%20of%20Pain.pdf) A medida que ascendemos en la Pirámide del Dolor, obtener Indicadores de Compromiso (IOC) específicos del adversario se vuelve cada vez más desafiante. Sin embargo, la otra cara de la moneda es que adquirir estos COI específicos obliga al adversario a modificar sus metodologías de ataque, una tarea que no es nada sencilla para ellos.
    
    ![](https://academy.hackthebox.com/storage/modules/214/pyramid.png)
    
    - `Hash Values`: Los valores hash son las huellas digitales de los archivos. Se crean utilizando algoritmos como MD5, SHA-1 o SHA-256 que toman una entrada (o "mensaje") y devuelven una cadena de bytes de tamaño fijo. Por ejemplo, los archivos binarios de malware se pueden identificar mediante sus valores hash únicos. Sin embargo, un ligero cambio en el archivo, como agregar un byte o cambiar un solo carácter, alterará drásticamente el valor hash, convirtiéndolo en un indicador fácil de cambiar y, por lo tanto, menos confiable.
    - `IP Addresses`: Las direcciones IP son identificadores únicos para dispositivos en una red. Se pueden utilizar para rastrear la fuente del tráfico de red o un posible ataque. Sin embargo, los adversarios suelen utilizar tácticas como la suplantación de IP, VPN, servidores proxy o redes TOR para ocultar sus verdaderas direcciones IP, lo que hace que este nivel de indicador sea fácil de cambiar y algo poco fiable.
    - `Domain Names`: Los dominios se utilizan para identificar una o más direcciones IP. Por ejemplo, el nombre de dominio www.ejemplo.com representa aproximadamente una docena de direcciones IP. Los actores maliciosos suelen utilizar algoritmos de generación de dominios (DGA) para producir una gran cantidad de nombres de dominio pseudoaleatorios para evadir la detección. También pueden utilizar servicios DNS dinámicos para cambiar rápidamente las direcciones IP asociadas a un dominio.
    - `Network/Host Artifacts`:
        - `Network Artifacts`: Estos son rastros residuales de las actividades de un atacante dentro de la infraestructura de la red. Se pueden encontrar en registros de red, capturas de paquetes, datos de flujo de red o registros de solicitudes de DNS, por nombrar algunos. Los ejemplos pueden incluir ciertos patrones en el tráfico de la red, encabezados de paquetes únicos o uso inusual de protocolos. Los artefactos de red son difíciles de modificar para un atacante sin afectar la efectividad o el sigilo de su operación.
        - `Host Artifacts`: Por otro lado, los artefactos del host se refieren a restos de actividad maliciosa que quedan en sistemas o terminales individuales. Estos se pueden encontrar en registros del sistema, sistemas de archivos, claves de registro, listas de procesos en ejecución, archivos DLL cargados o incluso en la memoria volátil. Por ejemplo, las entradas inusuales en el Registro de Windows, las rutas de archivo únicas o los procesos en ejecución sospechosos podrían considerarse artefactos del host. Estos indicadores también son bastante difíciles de modificar para un adversario sin afectar su campaña de intrusión o revelar su presencia.
        - El análisis de estos artefactos puede proporcionar información valiosa sobre las herramientas, técnicas y procedimientos (TTP) de un adversario y ayudar en la detección y prevención de futuros ataques. Sin embargo, la posición más alta de los artefactos de red y host en la pirámide del dolor indica que son más difíciles de utilizar para la detección y también más difíciles de cambiar u ofuscar para el atacante.
    - `Tools`: Las herramientas se refieren al software utilizado por los adversarios para realizar sus ataques. Esto podría incluir malware, exploits, scripts o marcos de comando y control (C2). Identificar las herramientas utilizadas por un adversario puede proporcionar información valiosa sobre sus capacidades e intenciones. Sin embargo, los adversarios sofisticados suelen utilizar herramientas personalizadas o modificar las existentes para evadir la detección.
    - `TTPs (Tactics, Techniques, and Procedures)`: Este es el pináculo de la Pirámide del Dolor. Los TTP se refieren a los métodos específicos utilizados por los adversarios para realizar sus ataques. Las tácticas describen los objetivos generales del adversario, las técnicas describen las acciones tomadas para lograr esos objetivos y los procedimientos son los pasos exactos que se toman para ejecutar las técnicas. Identificar los TTP de un adversario puede proporcionar la información más valiosa sobre sus operaciones y son los más difíciles de cambiar para un adversario sin un costo y esfuerzo significativos. Los ejemplos podrían incluir el uso de correos electrónicos de phishing para el acceso inicial (táctica), la explotación de una vulnerabilidad de software específica (técnica) y los pasos específicos tomados para explotar esa vulnerabilidad (procedimiento).
- `Diamond Model`: El [Modelo de diamante de análisis de intrusión](https://apps.dtic.mil/sti/pdfs/ADA586960.pdf) es un marco conceptual diseñado para ilustrar los aspectos fundamentales de una intrusión cibernética. Este modelo, desarrollado por Sergio Caltagirone, Andrew Pendergast y Christopher Betz, tiene como objetivo proporcionar un enfoque más estructurado para comprender, analizar y responder a las amenazas cibernéticas.El modelo está estructurado en torno a cuatro componentes clave, representados como vértices de un diamante:
    
    ![](https://academy.hackthebox.com/storage/modules/214/diamond.png)
    
    - `Adversary`: Representa al individuo, grupo u organización responsable de la intrusión cibernética. Es importante comprender sus capacidades, motivaciones e intenciones para defenderse eficazmente de sus ataques.
    - `Capability`: Representa las herramientas, técnicas y procedimientos (TTP) que utiliza el adversario para llevar a cabo la intrusión. Esto podría incluir malware, exploits y otras herramientas maliciosas, así como los métodos específicos utilizados para implementar estas herramientas.
    - `Infrastructure`: Representa los recursos físicos y virtuales que utiliza el adversario para facilitar la intrusión. Puede incluir servidores, nombres de dominio, direcciones IP y otros recursos de red utilizados para distribuir malware, controlar sistemas comprometidos o filtrar datos.
    - `Victim`: Esto representa el objetivo de la intrusión, que podría ser un individuo, una organización o un sistema. Comprender las vulnerabilidades de la víctima, el valor de sus activos y su posible exposición a amenazas es crucial para una defensa eficaz.
    
    Estos cuatro componentes están conectados por flechas bidireccionales, que representan las relaciones dinámicas y las interacciones entre ellos. Por ejemplo, un adversario utiliza capacidades a través de una infraestructura para atacar a una víctima. Este modelo permite capturar relaciones complejas y construir estrategias sólidas para la detección, mitigación y predicción de amenazas.
    
    Comparando esto con el modelo Cyber ​​Kill Chain, podemos ver que el modelo Diamond proporciona una visión más detallada del ecosistema de intrusión cibernética. Mientras que Cyber ​​Kill Chain se centra más en las etapas de un ataque (desde el reconocimiento hasta las acciones sobre objetivos), el Modelo Diamante proporciona una visión más holística de los componentes involucrados en la intrusión y sus interrelaciones.
    
    Consideremos un ejemplo técnico para ilustrar el modelo diamante: Supongamos que una institución financiera (víctima) es el objetivo de un grupo cibercriminal (adversario). El grupo utiliza correos electrónicos de phishing (Capacidad) enviados desde una botnet (Infraestructura) para entregar un troyano bancario. Cuando un destinatario hace clic en un enlace malicioso del correo electrónico, el troyano se instala en su sistema, lo que permite a los ciberdelincuentes robar datos financieros confidenciales.
    
    En este escenario, el Modelo Diamante ayuda a resaltar la interacción entre los diferentes componentes de la intrusión. Al analizar estos componentes y sus interacciones, la institución financiera puede obtener una comprensión más profunda de la amenaza que enfrenta y desarrollar estrategias más efectivas para mitigar ésta y futuras amenazas. Esto podría implicar fortalecer sus protocolos de seguridad de correo electrónico, monitorear signos del troyano bancario específico o implementar medidas para detectar y responder a actividad inusual de la red asociada con la botnet.
    
    En general, el Modelo Diamante proporciona una perspectiva complementaria a la Cyber ​​Kill Chain, ofreciendo una lente diferente a través de la cual comprender y responder a las ciberamenazas. Ambos modelos pueden ser herramientas útiles en el arsenal de un profesional de la ciberseguridad.