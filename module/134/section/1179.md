# Intro to IDOR

`Insecure Direct Object References (IDOR)`Las vulnerabilidades se encuentran entre las vulnerabilidades web más comunes y pueden afectar significativamente la aplicación web vulnerable. Las vulnerabilidades de IDOR ocurren cuando una aplicación web expone una referencia directa a un objeto, como un archivo o un recurso de base de datos, que el usuario final puede controlar directamente para obtener acceso a otros objetos similares. Si algún usuario puede acceder a cualquier recurso debido a la falta de un sistema de control de acceso sólido, el sistema se considera vulnerable.

Construir un sistema de control de acceso sólido es muy desafiante, por lo que las vulnerabilidades de IDOR son generalizadas. Además, la automatización del proceso de identificación de debilidades en los sistemas de control de acceso también es bastante difícil, lo que puede llevar a que estas vulnerabilidades no se identifiquen hasta que alcancen la producción.

Por ejemplo, si los usuarios solicitan acceso a un archivo que cargaron recientemente, pueden obtener un enlace como (`download.php?file_id=123`). Entonces, como el enlace hace referencia directamente al archivo (`file_id=123`), ¿qué pasaría si intentara acceder a otro archivo (que puede no pertenecernos) con (`download.php?file_id=124`)? Si la aplicación web no tiene un sistema de control de acceso adecuado en el back-end, es posible que podamos acceder a cualquier archivo enviando una solicitud con su`file_id`. En muchos casos, podemos encontrar que el`id`es fácilmente adivinable, lo que permite recuperar muchos archivos o recursos a los que no deberíamos tener acceso en función de nuestros permisos.

---

# **Lo que hace una vulnerabilidad de Idor**

Simplemente exponer una referencia directa a un objeto o recurso interno no es una vulnerabilidad en sí misma. Sin embargo, esto puede hacer posible explotar otra vulnerabilidad: un`weak access control system`. Muchas aplicaciones web restringen que los usuarios accedan a los recursos restringirlos para acceder a las páginas, funciones y API que pueden recuperar estos recursos. Sin embargo, ¿qué pasaría si un usuario de alguna manera tuviera acceso a estas páginas (por ejemplo, a través de un enlace compartido/adivinado)? ¿Todavía podrían acceder a los mismos recursos simplemente teniendo el enlace para acceder a ellos? Si la aplicación web no tenía un sistema de control de acceso en el back-end que compara la autenticación del usuario con la lista de acceso del recurso, podrían hacerlo.

Hay muchas formas de implementar un sistema de control de acceso sólido para aplicaciones web, como tener un control de acceso basado en roles ([RBAC](https://en.wikipedia.org/wiki/Role-based_access_control)) sistema. La conclusión principal es que`an IDOR vulnerability mainly exists due to the lack of an access control on the back-end`. Si un usuario tuviera referencias directas a objetos en una aplicación web que carece de control de acceso, sería posible que los atacantes vean o modifiquen los datos de otros usuarios.

Muchos desarrolladores ignoran la construcción de un sistema de control de acceso; Por lo tanto, la mayoría de las aplicaciones web y las aplicaciones móviles quedan desprotegidas en el back-end. En tales aplicaciones, todos los usuarios pueden tener acceso arbitrario a todos los datos de los demás usuarios en el back-end. Lo único que impide que los usuarios accedan a los datos de otros usuarios sería la implementación front-end de la aplicación, que está diseñada solo para mostrar los datos del usuario. En tales casos, la manipulación manual de las solicitudes HTTP puede revelar que todos los usuarios tienen acceso completo a todos los datos, lo que lleva a un ataque exitoso.

Todo esto hace que las vulnerabilidades de IDOR entre las vulnerabilidades más críticas para cualquier aplicación web o móvil, no solo debido a la exposición de referencias de objetos directos, sino que principalmente debido a la falta de un sistema de control de acceso sólido. Incluso un sistema de control de acceso básico puede ser difícil de desarrollar. Un sistema integral de control de acceso que cubre toda la aplicación web sin interferir con sus funciones podría ser una tarea aún más difícil. Esta es la razón por la cual las vulnerabilidades de control de IDOR/acceso se encuentran incluso en aplicaciones web muy grandes, como[Facebook](https://infosecwriteups.com/disclose-private-attachments-in-facebook-messenger-infrastructure-15-000-ae13602aa486), [Instagram](https://infosecwriteups.com/add-description-to-instagram-posts-on-behalf-of-other-users-6500-7d55b4a24c5a), y[Gorjeo](https://medium.com/@kedrisec/publish-tweets-by-any-other-user-6c9d892708e3).

---

# **Impacto de las vulnerabilidades de IDOR**

Como se mencionó anteriormente, las vulnerabilidades de IDOR pueden tener un impacto significativo en las aplicaciones web. El ejemplo más básico de una vulnerabilidad IDOR es acceder a archivos privados y recursos de otros usuarios a los que no deberían ser accesibles para nosotros, como archivos personales o datos de tarjetas de crédito, que se conoce como`IDOR Information Disclosure Vulnerabilities`. Dependiendo de la naturaleza de la referencia directa expuesta, la vulnerabilidad puede incluso permitir la modificación o eliminación de los datos de otros usuarios, lo que puede conducir a una adquisición completa de la cuenta.

Una vez que un atacante identifica las referencias directas, que pueden ser ID de base de datos o parámetros de URL, puede comenzar a probar patrones específicos para ver si pueden obtener acceso a cualquier dato y eventualmente puede comprender cómo extraer o modificar datos para cualquier usuario arbitrario.

Las vulnerabilidades de IDOR también pueden conducir a la elevación de los privilegios de los usuarios de un usuario estándar a un usuario administrador, con`IDOR Insecure Function Calls`. Por ejemplo, muchas aplicaciones web exponen parámetros de URL o API para funciones solo de administración en el código front-end de la aplicación web y deshabilitan estas funciones para usuarios que no son de administración. Sin embargo, si tuviéramos acceso a tales parámetros o API, podemos llamarlos con nuestros privilegios de usuario estándar. Supongamos que el back-end no negó explícitamente a los usuarios que no son de administración de llamar a estas funciones. En ese caso, podemos realizar operaciones administrativas no autorizadas, como cambiar las contraseñas de los usuarios o otorgar a los usuarios ciertos roles, lo que eventualmente puede conducir a una adquisición total de toda la aplicación web.